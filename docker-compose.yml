version: "3"

volumes:
  mongo-data:

services:
  nuxt:
    build: ./
    restart: always
    container_name: fairceptron-nuxt
    environment:
      - MONGO_DB_USER=mongoose
      - MONGO_DB_PASS=ckhc4VZ8HzEFIZYoxK5
      - MONGO_DB_NAME=fairceptron
      - MONGO_AUTH_SOURCE=fairceptron
      - MONGO_DOMAIN=mongodb # name of the db service (docker network)
      - MONGO_PORT=27017
    ports:
      - "3000:3000"
    command:
      "yarn run start"

  mongodb:
    image: "mongo:4"
    container_name: fairceptron-mongodb
    environment:
      - MONGO_INITDB_DATABASE=fairceptron
      - MONGO_INITDB_ROOT_USERNAME=admin
      - MONGO_INITDB_ROOT_PASSWORD=MdxFEqr7LO5c7Tbm8dy
    volumes:
      - ./init-mongo.js:/docker-entrypoint-initdb.d/init-mongo.js:ro
      - mongo-data:/data/db
    ports:
      - '27017-27019:27017-27019'